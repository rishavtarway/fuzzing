# Issues Analysis

## **heap-buffer-overflow issues in _cup_strcasecmp()**

https://issues.oss-fuzz.com/issues/425145247

https://issues.oss-fuzz.com/issues/425406125

https://issues.oss-fuzz.com/issues/425418727

stack trace:

![img](issues.assets/wps1.jpg) 

![img](issues.assets/wps2.jpg) 

cups_find_option:

![img](issues.assets/wps3.jpg) 

![img](issues.assets/wps4.jpg) 

 

![img](issues.assets/wps5.jpg) 

string.c :

crash in _cups_strcasecmp

![img](issues.assets/wps6.jpg)

If s and t does not end in ‘\0’, it will be read out of bounds.

 

the same as crash in cupsCopyString:

 

![img](issues.assets/wps7.jpg) 

 

crash case: ![img](issues.assets/wps8.jpg)

fuzzer:

![img](issues.assets/wps9.jpg)
In actual operation, this problem should not occur, so I believe it is due to false positives caused by the quality of the fuzzer generated by the large model. Of course, the code can also be modified to enhance its robustness (I don't know if it is necessary, because normally target functions will not pass in illegal strings).